---
title: "Visualizations"
author: "LeTicia Cancel"
date: "11/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## libraries
```{r}
library(quanteda)
library(tm)
library(SnowballC)
library(wordcloud)
```

## wordcloud testing

https://www.rdocumentation.org/packages/tm/versions/0.7-8/topics/Corpus 

```{r warning=FALSE,message=FALSE}
#fake
fake_output_df <- output_df %>%
  filter(DocType == "Fake") %>%
  select(-c(docId,DocType))


#fake
v = sort(colSums(fake_output_df),decreasing = TRUE)
myNames = names(v)
d = data.frame(word=myNames,freq=v)
wordcloud(d$word, colors=c(3,4),random.color=FALSE,d$freq,min.freq=60)

#true
true_output_df <- output_df %>%
  filter(DocType == "True") %>%
  select(-c(docId,DocType))

#true
v2 = sort(colSums(true_output_df),decreasing = TRUE)
myNames2 = names(v2)
d2 = data.frame(word=myNames2,freq=v2)
wordcloud(d2$word, colors=c(3,4),random.color=FALSE,d2$freq,min.freq=60)
```

## networkD3 testing

https://christophergandrud.github.io/networkD3/
https://blog.rstudio.com/2018/10/05/r2d3-r-interface-to-d3-visualizations/

```{r}
library(networkD3)
library(tidytext)
library(r2d3)
library(shiny)
library(dplyr)
library(here)

head(true_df)

#convert text column from factor to character 
true_df <- mutate(true_df, text = as.character(true_df$text))

#total count of words in true
true_df_words <- true_df %>%
  unnest_tokens(word,text) %>%
  anti_join(get_stopwords()) %>%
  count(type, word, sort = TRUE)

true_df_words %>%
  select(-c(type)) %>%
  filter(!word %in% c("s","â")) %>%
  top_n(20, n) %>%
  ggplot(aes(word, n)) +
  geom_col() + 
  coord_flip()

top_true_df_words <- true_df_words %>%
  select(-c(type)) %>%
  filter(!word %in% c("s","â")) %>%
  top_n(20, n)

#create tsv for r2d3 testing
con<-file(here('model_scripts','data.tsv'),encoding="UTF-8")
write.table(top_true_df_words,file=con , row.names = FALSE, sep = "\t")
```

testing
```{r}
URL <- paste0(
        "https://cdn.rawgit.com/christophergandrud/networkD3/",
        "master/JSONdata//flare.json")

## Convert to list format
Flare <- jsonlite::fromJSON(URL, simplifyDataFrame = FALSE)

# Use subset of data for more readable diagram
Flare$children = Flare$children[1:3]

radialNetwork(List = Flare, fontSize = 10, opacity = 0.9)
```

## r2d3 testing

Top 20 words from True DF
```{r}
dataset <- readr::read_tsv("data.tsv")
```

```{r}
r2d3::r2d3(data=dataset, script = "d3_scripts.js", d3_version = "3", container = "div")
```






## working chart to use as reference only 
create dataset 
```{r}
dataset_test <- readr::read_tsv("data_testing.tsv")
```

```{r}
r2d3::r2d3(data=dataset_test, script = "d3_scripts_copy.js", d3_version = "3", container = "div")
```

